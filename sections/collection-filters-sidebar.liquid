{% comment %}
  Collection Filters Sidebar
  Inspired by the grocery template design but adapted for clothing
{% endcomment %}

<div class="bg-white dark:bg-gray-800 rounded-lg shadow-card p-6 h-full">
  <!-- Price Range Filter -->
  <div class="mb-8">
    <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4">Price Range</h3>
    <div class="price-range-slider">
      <div class="range-slider">
        <input type="range" min="0" max="1000" value="100" class="range-min w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer">
        <input type="range" min="0" max="1000" value="500" class="range-max w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer mt-1">
      </div>
      <div class="flex justify-between items-center mt-4">
        <div class="price-input">
          <span class="text-gray-600 dark:text-gray-400">$</span>
          <input type="number" value="100" min="0" max="1000" class="w-16 px-2 py-1 border border-gray-300 dark:border-gray-700 rounded-md text-sm">
        </div>
        <div class="text-gray-500 dark:text-gray-400">-</div>
        <div class="price-input">
          <span class="text-gray-600 dark:text-gray-400">$</span>
          <input type="number" value="500" min="0" max="1000" class="w-16 px-2 py-1 border border-gray-300 dark:border-gray-700 rounded-md text-sm">
        </div>
      </div>
    </div>
  </div>
  
  <!-- Product Status Filter -->
  <div class="mb-8">
    <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4">Product Status</h3>
    <div class="space-y-3">
      <label class="flex items-center">
        <input type="checkbox" class="form-checkbox h-5 w-5 text-primary rounded border-gray-300 dark:border-gray-700 focus:ring-primary">
        <span class="ml-3 text-gray-700 dark:text-gray-300">On sale</span>
      </label>
      <label class="flex items-center">
        <input type="checkbox" class="form-checkbox h-5 w-5 text-primary rounded border-gray-300 dark:border-gray-700 focus:ring-primary">
        <span class="ml-3 text-gray-700 dark:text-gray-300">In Stock</span>
      </label>
    </div>
  </div>
  
  <!-- Categories Filter -->
  <div class="mb-8">
    <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4">Categories</h3>
    <div class="space-y-3 max-h-60 overflow-y-auto pr-2">
      {% for collection in collections %}
        {% if collection.all_products_count > 0 %}
          <a href="{{ collection.url }}" class="flex items-center justify-between group">
            <span class="text-gray-700 dark:text-gray-300 group-hover:text-primary transition-colors duration-200">{{ collection.title }}</span>
            <span class="text-gray-500 dark:text-gray-400 text-sm">({{ collection.all_products_count }})</span>
          </a>
        {% endif %}
      {% endfor %}
    </div>
  </div>
  
  <!-- Color Filter -->
  <div class="mb-8">
    <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4">Filter by Color</h3>
    <div class="space-y-3">
      {% assign color_options = 'Red,Green,Gray,Orange,Purple,Yellow,Olive,Blue,Black,White,Pink,Brown' | split: ',' %}
      {% for color in color_options %}
        <label class="flex items-center">
          <input type="checkbox" class="form-checkbox h-5 w-5 text-primary rounded border-gray-300 dark:border-gray-700 focus:ring-primary">
          <span class="ml-3 text-gray-700 dark:text-gray-300">{{ color }}</span>
        </label>
      {% endfor %}
    </div>
  </div>
  
  <!-- Rating Filter -->
  <div class="mb-8">
    <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4">Rating</h3>
    <div class="space-y-3">
      <label class="flex items-center">
        <input type="checkbox" class="form-checkbox h-5 w-5 text-primary rounded border-gray-300 dark:border-gray-700 focus:ring-primary">
        <span class="ml-3 flex items-center">
          <span class="flex">
            {% for i in (1..5) %}
              <svg class="w-4 h-4 text-yellow-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
              </svg>
            {% endfor %}
          </span>
        </span>
      </label>
      
      <label class="flex items-center">
        <input type="checkbox" class="form-checkbox h-5 w-5 text-primary rounded border-gray-300 dark:border-gray-700 focus:ring-primary">
        <span class="ml-3 flex items-center">
          <span class="flex">
            {% for i in (1..4) %}
              <svg class="w-4 h-4 text-yellow-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
              </svg>
            {% endfor %}
            <svg class="w-4 h-4 text-gray-300 dark:text-gray-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
            </svg>
          </span>
          <span class="ml-1 text-gray-600 dark:text-gray-400">& up</span>
        </span>
      </label>
      
      <label class="flex items-center">
        <input type="checkbox" class="form-checkbox h-5 w-5 text-primary rounded border-gray-300 dark:border-gray-700 focus:ring-primary">
        <span class="ml-3 flex items-center">
          <span class="flex">
            {% for i in (1..3) %}
              <svg class="w-4 h-4 text-yellow-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
              </svg>
            {% endfor %}
            {% for i in (1..2) %}
              <svg class="w-4 h-4 text-gray-300 dark:text-gray-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
              </svg>
            {% endfor %}
          </span>
          <span class="ml-1 text-gray-600 dark:text-gray-400">& up</span>
        </span>
      </label>
      
      <label class="flex items-center">
        <input type="checkbox" class="form-checkbox h-5 w-5 text-primary rounded border-gray-300 dark:border-gray-700 focus:ring-primary">
        <span class="ml-3 flex items-center">
          <span class="flex">
            {% for i in (1..2) %}
              <svg class="w-4 h-4 text-yellow-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
              </svg>
            {% endfor %}
            {% for i in (1..3) %}
              <svg class="w-4 h-4 text-gray-300 dark:text-gray-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
              </svg>
            {% endfor %}
          </span>
          <span class="ml-1 text-gray-600 dark:text-gray-400">& up</span>
        </span>
      </label>
      
      <label class="flex items-center">
        <input type="checkbox" class="form-checkbox h-5 w-5 text-primary rounded border-gray-300 dark:border-gray-700 focus:ring-primary">
        <span class="ml-3 flex items-center">
          <span class="flex">
            <svg class="w-4 h-4 text-yellow-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
            </svg>
            {% for i in (1..4) %}
              <svg class="w-4 h-4 text-gray-300 dark:text-gray-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
              </svg>
            {% endfor %}
          </span>
          <span class="ml-1 text-gray-600 dark:text-gray-400">& up</span>
        </span>
      </label>
    </div>
  </div>
  
  <!-- Top Rated Products -->
  <div>
    <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4">Top Rated Products</h3>
    <div class="space-y-4">
      {% assign top_products = collections.all.products | sort: 'metafields.reviews.rating' | reverse | limit: 4 %}
      {% for product in top_products %}
        <div class="flex space-x-3">
          <a href="{{ product.url }}" class="flex-shrink-0 w-16 h-16">
            {% if product.featured_image != blank %}
              <img src="{{ product.featured_image | img_url: 'small' }}" alt="{{ product.title }}" class="w-full h-full object-cover rounded-md">
            {% else %}
              <div class="w-full h-full bg-gray-200 dark:bg-gray-700 rounded-md flex items-center justify-center">
                <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
              </div>
            {% endif %}
          </a>
          <div class="flex-grow">
            <div class="flex items-center mb-1">
              <div class="flex">
                {% assign rating = product.metafields.reviews.rating | default: 4.5 | round %}
                {% for i in (1..5) %}
                  {% if i <= rating %}
                    <svg class="w-3 h-3 text-yellow-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                    </svg>
                  {% else %}
                    <svg class="w-3 h-3 text-gray-300 dark:text-gray-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                    </svg>
                  {% endif %}
                {% endfor %}
              </div>
              <span class="text-xs text-gray-500 dark:text-gray-400 ml-1">({{ product.metafields.reviews.rating_count | default: 12 }})</span>
            </div>
            <h4 class="text-sm font-medium text-gray-900 dark:text-white hover:text-primary transition-colors duration-200">
              <a href="{{ product.url }}">{{ product.title | truncate: 25 }}</a>
            </h4>
            <div class="text-sm font-bold text-primary mt-1">
              {% if product.compare_at_price > product.price %}
                <span>{{ product.price | money }}</span>
                <span class="text-gray-400 line-through text-xs ml-1">{{ product.compare_at_price | money }}</span>
              {% else %}
                <span>{{ product.price | money }}</span>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Price Range Slider
    const rangeMin = document.querySelector('.range-min');
    const rangeMax = document.querySelector('.range-max');
    const minInput = document.querySelectorAll('.price-input input')[0];
    const maxInput = document.querySelectorAll('.price-input input')[1];
    
    if (rangeMin && rangeMax && minInput && maxInput) {
      // Set min and max values for the range inputs
      const minValue = parseInt(rangeMin.value);
      const maxValue = parseInt(rangeMax.value);
      
      // Update min input value when range min changes
      rangeMin.addEventListener('input', function() {
        const value = parseInt(this.value);
        if (value > maxValue) {
          this.value = maxValue;
          minInput.value = maxValue;
        } else {
          minInput.value = value;
        }
      });
      
      // Update max input value when range max changes
      rangeMax.addEventListener('input', function() {
        const value = parseInt(this.value);
        if (value < minValue) {
          this.value = minValue;
          maxInput.value = minValue;
        } else {
          maxInput.value = value;
        }
      });
      
      // Update range min when min input changes
      minInput.addEventListener('input', function() {
        const value = parseInt(this.value);
        if (value > maxValue) {
          this.value = maxValue;
          rangeMin.value = maxValue;
        } else {
          rangeMin.value = value;
        }
      });
      
      // Update range max when max input changes
      maxInput.addEventListener('input', function() {
        const value = parseInt(this.value);
        if (value < minValue) {
          this.value = minValue;
          rangeMax.value = minValue;
        } else {
          rangeMax.value = value;
        }
      });
    }
  });
</script>

{% schema %}
{
  "name": "Collection Filters Sidebar",
  "tag": "section",
  "class": "section",
  "settings": []
}
{% endschema %}